
- $pre_fetch:
  id: host.www1.ping
  command: "ping -W 2 -n -c 1 172.30.0.61 > /dev/null || ping -W 2 -n -c 1 172.30.0.61 > /dev/null"
  ignorets: true
  timeout: 3


- $pre_fetch:
  id: host.www1.snmp.pf
  # May have to edit the specific oids, these are good for centos 6
  command: "smgscripts/snmp_pf.sh public 172.30.0.61 /tmp/smg-snmp-pf-www1.out laLoad.1 laLoad.2 \
    ssCpuRawUser.0 ssCpuRawNice.0 ssCpuRawSystem.0 ssCpuRawIdle.0 ssCpuRawWait.0 ssCpuRawInterrupt.0 \
    ssCpuRawSoftIRQ.0 ssRawInterrupts.0 ssRawContexts.0 ssIORawSent.0 ssIORawReceived.0 \
    ssSwapIn.0 ssSwapOut.0 ifHCInOctets.2 ifHCOutOctets.2 tcpPassiveOpens.0 tcpActiveOpens.0 tcpCurrEstab.0"
  timeout: 10
  pre_fetch: host.www1.ping


- ^host.www1:
  title: "Host: www1"
  px: "host.www1."
  parent: hosts
  desc: "www1 graphs"

- host.www1.sysload:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out laLoad.1 laLoad.2"
  title: "www1 - Load average over 1/5 min periods"
  interval: 60
  vars:
    - label: sl1min
    - label: sl5min

- host.www1.cpu:
  title: "www1 - CPU usage"
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssCpuRawUser.0 ssCpuRawNice.0 \
  ssCpuRawSystem.0 ssCpuRawIdle.0 ssCpuRawWait.0 ssCpuRawInterrupt.0 ssCpuRawSoftIRQ.0"
  rrdType: COUNTER
  stack: true
  interval: 60
  vars:
    - label: user
      mu: "%"
      max: 10000
      lt: "AREA"
    - label: nice
      mu: "%"
      max: 10000
      lt: "AREA"
    - label: system
      mu: "%"
      max: 10000
      lt: "AREA"
    - label: idle
      mu: "%"
      max: 10000
      alert-warn-lt: 1
      alert-crit-lt: 0
      lt: "AREA"
    - label: iowait
      mu: "%"
      max: 10000
      lt: "AREA"
    - label: irq
      mu: "%"
      max: 10000
      lt: "AREA"
    - label: softirq
      mu: "%"
      max: 10000
      lt: "AREA"


- host.www1.cpu0:
  title: "www1 - User and System CPU usage"
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssCpuRawUser.0 ssCpuRawSystem.0"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: user
      mu: "%"
      max: 10000
    - label: sys
      mu: "%"
      max: 10000

- host.www1.cpu1:
  title: "www1 - Nice and Wait CPU usage"
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssCpuRawNice.0 ssCpuRawWait.0"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: nice
      mu: "%"
      max: 10000
    - label: wait
      mu: "%"
      max: 10000

- host.www1.intctx:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssRawInterrupts.0 ssRawContexts.0"
  title: "www1 - Interrupts/context switches"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: ints
      max: 10000000000
    - label: ctxs
      max: 10000000000

- host.www1.blkio:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssIORawSent.0 ssIORawReceived.0"
  title: "www1 - Block Device I/O"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: wrtn
      mu: "blk/s"
      max: 10000000000
    - label: read
      mu: "blk/s"
      max: 10000000000

#- host.www1.swpio:
#  pre_fetch: host.www1.snmp.pf
#  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ssSwapIn.0 ssSwapOut.0"
#  title: "www1 - Swap I/O"
#  rrdType: GAUGE
#  interval: 60
#  vars:
#    - label: in
#      mu: "B"
#    - label: out
#      mu: "B"
#      alert-warn-gt: 1000000 
#      alert-crit-gt: 100000000

- host.www1.netio:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out ifHCInOctets.2 ifHCOutOctets.2"
  title: "www1 - Network I/O Octets"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: in
      mu: "b/s"
      cdef: "$ds,8,*"
      max: 12500000000
      # 750000000 * 8 = 6Gbps, 1000000000 * 8 = 8Gbps
      alert-warn-gt: 750000000 
      alert-crit-gt: 1000000000
    - label: out
      mu: "b/s"
      cdef: "$ds,8,*"
      max: 12500000000
      # 750000000 * 8 = 6Gbps, 1000000000 * 8 = 8Gbps
      alert-warn-gt: 750000000 
      alert-crit-gt: 1000000000


- host.www1.newconn:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out tcpPassiveOpens.0 tcpActiveOpens.0"
  title: "www1 - Network New Connections"
  rrdType: COUNTER
  interval: 60
  vars:
    - label: in
      mu: "c/s"
      max: 10000000000
    - label: out
      max: 10000000000
      mu: "c/s"

- host.www1.estconn:
  pre_fetch: host.www1.snmp.pf
  command: "smgscripts/snmp_pf_get.sh /tmp/smg-snmp-pf-www1.out tcpCurrEstab.0"
  title: "www1 - Network Established Connections"
  interval: 60
  vars:
    - label: conns

- host.www1.mempercent:
  command: "smgscripts/snmp_mem.sh 172.30.0.61"
  timeout: 5
  title: "www1 - Memory Used"
  rrdType: GAUGE
  interval: 300
  vars:
    - label: total used
      mu: "%"
    - label: used w/o buf/cache
      mu: "%"
      alert-warn-gt: 90
      alert-crit-gt: 95


#- host.www1.swappercent:
#  command: "smgscripts/snmp_swap.sh www1"
#  timeout: 5
#  title: "www1 - Swap Used"
#  rrdType: GAUGE
#  interval: 300
#  vars:
#    - label: perc
#      mu: "%"

