# A pertsistence volume whete to store state, use cloud-provisioned one for HA instead (and if available)
# On premises: mkdir -p /opt/smg/data/ first and make sure SMG runs on a Node which has the volume (e.g. using labels)
# The "base" data volume
apiVersion: v1
kind: PersistentVolume
metadata:
  name: smg-data-vol1
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 100Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/opt/smg/data"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: smg-data-vol1-claim
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: "manual"
  resources:
    requests:
      storage: 100Gi
---
# keep our (generated by Kube plugin) scrape targets alive between restarts
# note that we are using location within the data volume host path to keep everything under one base dir on the host
apiVersion: v1
kind: PersistentVolume
metadata:
  name: smg-conf-scrape-targets-vol1
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 100Mi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/opt/smg/data/conf/scrape-targets.d"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: smg-conf-scrape-targets-vol1-claim
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: "manual"
  resources:
    requests:
      storage: 100Mi
---
# keep our (generated by Scrape plugin) smg confs alive between restarts
# note that we are using location within the data volume host path to keep everything under one base dir on the host
apiVersion: v1
kind: PersistentVolume
metadata:
  name: smg-conf-scrape-private-vol1
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 100Mi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/opt/smg/data/conf/scrape-private.d"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: smg-conf-scrape-private-vol1-claim
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: "manual"
  resources:
    requests:
      storage: 100Mi
