<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>SMG Howto – Network</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 48em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="index.html">Back To Index</a></p>
<h1 id="how-to-monitor-network-switches">How to monitor Network switches</h1>
<p>These days it is less common for people to need to monitor network switches as a lot of companies run their services in some of the “cloud” vendors where the provider is owning and handling the actual underlying network infrastructure and that is transparent to their customers.</p>
<p>Yet if you run something in your own data center chances are that this also involves some network infrastructure in the form of network router devices.</p>
<p>These can come from a bunch of vendors including Cisco, Arista etc and configring them is vendor-specific (and totally out of scope of this doc) but normally all of these support SNMP which needs to be enabled for monitoring to work.</p>
<p>Ask your network administrator to enable SNMP (v2c) on the device and provide you with the IP address where that can be accessed, together with the SNMP “community string” (akin to password). Note that if you are using something like MRTG to get traffic graphs from these chances are that you already have these available.</p>
<p>For the example we will use a network switch named racksw1.host, with “management” IP of 192.168.10.1 and SNMP community of “private”.</p>
<p>First, verify that SNMP is working as expected, you will need snmpget and snmpwalk available. You can use a running SMG container instance to do that like this:</p>
<pre><code>docker exec smg snmpget -v2c -c private 192.168.10.1 sysDescr.0</code></pre>
<p>If that works we can proceed with configuring the SMG Autoconf target which would generate SMG configs to watch the device, using the <a href="https://github.com/asen/smg/blob/master/smgconf/ac-templates/netsw-snmp.yml.ssp">netsw-snmp template</a>:</p>
<pre><code>cat &gt; /opt/smg/data/conf/autoconf.d/racksw1.host-netsw.yml &lt;&lt;-EOH

- output: racksw1.host-netsw.yml
  template: netsw-snmp
  node_name: racksw1.host
  node_host: 192.168.10.1  # or resolve_name: true
  regen_delay: 1800 # this can be slow - run every 30 min instead of every minute
  context:
    snmp_community: private

EOH</code></pre>
<p>Then reload SMG conf as described <a href="Run_smg.html">here</a></p>
<p>As of this writing the template will generate one index for the device and a pair of graphs for each port - its traffic (ifHCInOctets/ifHCOutOctets converted in bits per sec) and ifOperStatus value - 1=up, 2=down, 3=tesing, 4=unknown, 5=dormant 6=notPresent 7=lowerLayerDown</p>
</body>
</html>
